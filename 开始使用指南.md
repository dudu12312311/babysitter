# ğŸš€ ä¸­å›½å®å®ç…§ç‰‡ç”Ÿæˆ - å¼€å§‹ä½¿ç”¨æŒ‡å—

## ğŸ“‹ ä½ ç°åœ¨æ‹¥æœ‰çš„æ–‡ä»¶

### âœ… æ ¸å¿ƒä»£ç æ–‡ä»¶ï¼ˆ5ä¸ªï¼‰
1. **chinese_baby_prompts.py** - æç¤ºè¯é…ç½®ç³»ç»Ÿ
2. **baby_photo_integration.py** - ç…§ç‰‡ç”Ÿæˆé›†æˆæ¨¡å—
3. **baby_photo_api.py** - Flask API ç«¯ç‚¹
4. **fal_ai_integration.py** - å®Œæ•´é›†æˆç¤ºä¾‹
5. **test_baby_photo.py** - æµ‹è¯•è„šæœ¬

### ğŸ“– æ–‡æ¡£æ–‡ä»¶ï¼ˆ5ä¸ªï¼‰
1. **å®å®ç…§ç‰‡åŠŸèƒ½æ€»ç»“.md** - å®Œæ•´åŠŸèƒ½æ€»ç»“
2. **å®å®ç…§ç‰‡é›†æˆæŒ‡å—.md** - è¯¦ç»†é›†æˆæŒ‡å—
3. **ä¿®æ”¹main.pyæŒ‡å—.md** - main.py ä¿®æ”¹æ­¥éª¤
4. **å¿«é€Ÿå‚è€ƒå¡.md** - å¿«é€ŸæŸ¥é˜…æ‰‹å†Œ
5. **å¼€å§‹ä½¿ç”¨æŒ‡å—.md** - æœ¬æ–‡ä»¶

### âœ… å·²æ›´æ–°çš„æ–‡ä»¶
- **requirements.txt** - å·²æ·»åŠ  fal-client ä¾èµ–

---

## ğŸ¯ 3ç§ä½¿ç”¨æ–¹å¼

### æ–¹å¼1: å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èæ–°æ‰‹ï¼‰

**é€‚åˆ**: æƒ³å…ˆæµ‹è¯•åŠŸèƒ½æ˜¯å¦æ­£å¸¸

```bash
# æ­¥éª¤1: å®‰è£…ä¾èµ–
pip install fal-client

# æ­¥éª¤2: è®¾ç½®APIå¯†é’¥
set FAL_KEY=ä½ çš„fal.aiå¯†é’¥

# æ­¥éª¤3: è¿è¡Œæµ‹è¯•
python test_baby_photo.py

# æ­¥éª¤4: å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œè¿è¡Œç¤ºä¾‹
python fal_ai_integration.py
```

### æ–¹å¼2: é›†æˆåˆ° Flask åº”ç”¨ï¼ˆæ¨èï¼‰

**é€‚åˆ**: æƒ³åœ¨ Web åº”ç”¨ä¸­ä½¿ç”¨

```bash
# æ­¥éª¤1: ä¿®æ”¹ main.py
# æŒ‰ç…§ "ä¿®æ”¹main.pyæŒ‡å—.md" çš„æ­¥éª¤æ“ä½œ

# æ­¥éª¤2: å¯åŠ¨åº”ç”¨
python main.py

# æ­¥éª¤3: æµ‹è¯• API
curl http://localhost:5000/api/baby-photo/health

# æ­¥éª¤4: ç”Ÿæˆç…§ç‰‡
curl -X POST http://localhost:5000/api/baby-photo/generate \
  -H "Content-Type: application/json" \
  -d "{\"age_months\": 6, \"gender\": \"boy\"}"
```

### æ–¹å¼3: ç›´æ¥åœ¨ä»£ç ä¸­ä½¿ç”¨

**é€‚åˆ**: æƒ³åœ¨æ¸¸æˆé€»è¾‘ä¸­ç›´æ¥è°ƒç”¨

```python
from baby_photo_integration import BabyPhotoGenerator

# åˆ›å»ºç”Ÿæˆå™¨
generator = BabyPhotoGenerator()

# ç”Ÿæˆç…§ç‰‡
result = generator.generate_baby_photo(
    age_months=6,
    gender="boy",
    expression="happy",
    scene="studio"
)

if result["success"]:
    print(f"ç…§ç‰‡URL: {result['image_url']}")
```

---

## ğŸ“ è¯¦ç»†æ­¥éª¤ï¼ˆæ–¹å¼2 - æ¨èï¼‰

### ç¬¬1æ­¥: å®‰è£…ä¾èµ–

æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿è¡Œï¼š

```bash
pip install fal-client
```

å¦‚æœæç¤ºæƒé™é”™è¯¯ï¼Œä½¿ç”¨ï¼š

```bash
pip install --user fal-client
```

### ç¬¬2æ­¥: è·å– API å¯†é’¥

1. è®¿é—® https://fal.ai/
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. è¿›å…¥ Settings â†’ API Keys
4. åˆ›å»ºæ–°çš„ API å¯†é’¥
5. å¤åˆ¶å¯†é’¥ï¼ˆç±»ä¼¼ï¼š`fal_xxx...`ï¼‰

### ç¬¬3æ­¥: è®¾ç½®ç¯å¢ƒå˜é‡

**Windows CMD:**
```cmd
set FAL_KEY=ä½ çš„å¯†é’¥
```

**Windows PowerShell:**
```powershell
$env:FAL_KEY="ä½ çš„å¯†é’¥"
```

**æ°¸ä¹…è®¾ç½®ï¼ˆæ¨èï¼‰:**
1. å³é”®"æ­¤ç”µè„‘" â†’ å±æ€§
2. é«˜çº§ç³»ç»Ÿè®¾ç½® â†’ ç¯å¢ƒå˜é‡
3. æ–°å»ºç”¨æˆ·å˜é‡ï¼š
   - å˜é‡åï¼š`FAL_KEY`
   - å˜é‡å€¼ï¼šä½ çš„å¯†é’¥

### ç¬¬4æ­¥: è¿è¡Œæµ‹è¯•

```bash
python test_baby_photo.py
```

**é¢„æœŸè¾“å‡º:**
```
ğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ª
å®å®ç…§ç‰‡ç”ŸæˆåŠŸèƒ½æµ‹è¯•
ğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ª

============================================================
æµ‹è¯• 1: æ£€æŸ¥æ¨¡å—å¯¼å…¥
============================================================
âœ… chinese_baby_prompts å¯¼å…¥æˆåŠŸ
âœ… baby_photo_integration å¯¼å…¥æˆåŠŸ
âœ… baby_photo_api å¯¼å…¥æˆåŠŸ

...

============================================================
æµ‹è¯•ç»“æœæ‘˜è¦
============================================================
æ¨¡å—å¯¼å…¥              âœ… é€šè¿‡
fal_client å®‰è£…       âœ… é€šè¿‡
API å¯†é’¥é…ç½®          âœ… é€šè¿‡
æç¤ºè¯ç”Ÿæˆ            âœ… é€šè¿‡
ç…§ç‰‡ç”Ÿæˆå™¨            âœ… é€šè¿‡
Flask Blueprint       âœ… é€šè¿‡

============================================================
æ€»è®¡: 6 é€šè¿‡, 0 å¤±è´¥
============================================================

ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç…§ç‰‡ç”ŸæˆåŠŸèƒ½å·²å°±ç»ªã€‚
```

### ç¬¬5æ­¥: ä¿®æ”¹ main.py

æ‰“å¼€ `main.py`ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä¿®æ”¹ï¼š

#### 5.1 æ·»åŠ å¯¼å…¥ï¼ˆåœ¨æ–‡ä»¶é¡¶éƒ¨ï¼‰

åœ¨ç°æœ‰å¯¼å…¥åæ·»åŠ ï¼š

```python
# å¯¼å…¥å®å®ç…§ç‰‡ç”Ÿæˆæ¨¡å—
try:
    from baby_photo_api import baby_photo_bp
    photo_api_available = True
    print("æˆåŠŸå¯¼å…¥å®å®ç…§ç‰‡ç”Ÿæˆæ¨¡å—")
except ImportError as e:
    print(f"å¯¼å…¥å®å®ç…§ç‰‡æ¨¡å—å¤±è´¥: {e}")
    photo_api_available = False
```

#### 5.2 æ³¨å†Œ Blueprintï¼ˆåœ¨åˆ›å»º app åï¼‰

```python
app = Flask(__name__)

# æ³¨å†Œå®å®ç…§ç‰‡ç”Ÿæˆ API
if photo_api_available:
    app.register_blueprint(baby_photo_bp)
    print("å®å®ç…§ç‰‡ç”Ÿæˆ API å·²æ³¨å†Œ")
```

#### 5.3 æ›´æ–°å¥åº·æ£€æŸ¥ï¼ˆå¯é€‰ï¼‰

```python
@app.route('/health')
def health():
    return jsonify({
        'status': 'healthy', 
        'message': 'åº”ç”¨è¿è¡Œæ­£å¸¸',
        'game_available': game_available,
        'photo_api_available': photo_api_available  # æ·»åŠ è¿™è¡Œ
    })
```

**å®Œæ•´ä»£ç å‚è€ƒ**: æŸ¥çœ‹ `ä¿®æ”¹main.pyæŒ‡å—.md`

### ç¬¬6æ­¥: å¯åŠ¨åº”ç”¨

```bash
python main.py
```

**é¢„æœŸè¾“å‡º:**
```
æˆåŠŸå¯¼å…¥æ¸¸æˆæ¨¡å—
æˆåŠŸå¯¼å…¥å®å®ç…§ç‰‡ç”Ÿæˆæ¨¡å—
å®å®ç…§ç‰‡ç”Ÿæˆ API å·²æ³¨å†Œ
å¼€å§‹å¯åŠ¨åº”ç”¨...
Pythonç‰ˆæœ¬: 3.x.x
å½“å‰å·¥ä½œç›®å½•: ...
æ¸¸æˆå®ä¾‹åˆ›å»ºæˆåŠŸ
å¯åŠ¨åº”ç”¨ï¼Œç«¯å£: 5000
åº”ç”¨å¯åŠ¨å®Œæˆï¼Œç­‰å¾…è¯·æ±‚...
```

### ç¬¬7æ­¥: æµ‹è¯•åŠŸèƒ½

#### 7.1 è®¿é—®é¦–é¡µ

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š`http://localhost:5000`

åº”è¯¥çœ‹åˆ°ï¼š
- ç…§ç‰‡ç”Ÿæˆ: å¯ç”¨

#### 7.2 æµ‹è¯•å¥åº·æ£€æŸ¥

è®¿é—®ï¼š`http://localhost:5000/api/baby-photo/health`

åº”è¯¥è¿”å›ï¼š
```json
{
  "status": "healthy",
  "fal_client_installed": true,
  "api_key_configured": true
}
```

#### 7.3 é¢„è§ˆæç¤ºè¯ï¼ˆä¸æ¶ˆè€—é…é¢ï¼‰

ä½¿ç”¨ Postman æˆ– curlï¼š

```bash
curl -X POST http://localhost:5000/api/baby-photo/preview-prompt ^
  -H "Content-Type: application/json" ^
  -d "{\"age_months\": 6, \"gender\": \"boy\", \"expression\": \"happy\"}"
```

#### 7.4 ç”Ÿæˆç…§ç‰‡

```bash
curl -X POST http://localhost:5000/api/baby-photo/generate ^
  -H "Content-Type: application/json" ^
  -d "{\"age_months\": 6, \"gender\": \"boy\", \"expression\": \"happy\", \"scene\": \"studio\"}"
```

**é¢„æœŸå“åº”:**
```json
{
  "success": true,
  "image_url": "https://fal.media/files/...",
  "metadata": {
    "age_months": 6,
    "age_stage": "infant_3_12",
    "gender": "boy",
    "expression": "happy",
    "scene": "studio"
  }
}
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### Q1: ImportError: No module named 'fal_client'

**è§£å†³:**
```bash
pip install fal-client
```

### Q2: ç…§ç‰‡ç”ŸæˆåŠŸèƒ½ä¸å¯ç”¨

**æ£€æŸ¥æ¸…å•:**
1. âœ… å·²å®‰è£… fal-client
2. âœ… å·²è®¾ç½® FAL_KEY ç¯å¢ƒå˜é‡
3. âœ… API å¯†é’¥æœ‰æ•ˆ
4. âœ… ç½‘ç»œè¿æ¥æ­£å¸¸

**è¯Šæ–­å‘½ä»¤:**
```bash
python test_baby_photo.py
```

### Q3: ç”Ÿæˆçš„ç…§ç‰‡ä¸æ˜¯ä¸­å›½å®å®

**åŸå› :** æç¤ºè¯æƒé‡å¯èƒ½ä¸å¤Ÿ

**è§£å†³:** ç¼–è¾‘ `chinese_baby_prompts.py`ï¼Œå¢åŠ æƒé‡ï¼š

```python
POSITIVE_PROMPT_BASE = """
(pure Chinese baby:1.8),  # ä» 1.5 å¢åŠ åˆ° 1.8
(single eyelid:1.3),      # ä» 1.2 å¢åŠ åˆ° 1.3
...
"""
```

### Q4: API è¿”å› 401 é”™è¯¯

**åŸå› :** API å¯†é’¥æ— æ•ˆæˆ–è¿‡æœŸ

**è§£å†³:**
1. æ£€æŸ¥å¯†é’¥æ˜¯å¦æ­£ç¡®
2. è®¿é—® fal.ai é‡æ–°ç”Ÿæˆå¯†é’¥
3. é‡æ–°è®¾ç½®ç¯å¢ƒå˜é‡

### Q5: ç”Ÿæˆé€Ÿåº¦å¾ˆæ…¢

**åŸå› :** æ­£å¸¸ç°è±¡ï¼Œæ¯å¼ ç…§ç‰‡éœ€è¦ 5-15 ç§’

**ä¼˜åŒ–å»ºè®®:**
1. ä½¿ç”¨å¼‚æ­¥å¤„ç†
2. æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
3. ç¼“å­˜ç”Ÿæˆçš„ç…§ç‰‡

---

## ğŸ“Š æˆæœ¬ä¼°ç®—

### fal.ai å®šä»·ï¼ˆå‚è€ƒï¼‰
- Flux Schnell æ¨¡å‹ï¼šçº¦ $0.003-0.01 / å¼ 
- 1024x1024 åˆ†è¾¨ç‡
- 4 æ­¥æ¨ç†

### ä½¿ç”¨å»ºè®®
- ä¸ºæ¯ä¸ªå®å®åªç”Ÿæˆä¸€æ¬¡ç…§ç‰‡
- ä¿å­˜ç…§ç‰‡ URL åˆ°æ•°æ®åº“
- ä¸‹è½½å¹¶å­˜å‚¨åˆ°è‡ªå·±çš„æœåŠ¡å™¨

---

## ğŸ“ è¿›é˜¶ä½¿ç”¨

### 1. æ‰¹é‡ç”Ÿæˆ

```python
from fal_ai_integration import batch_generate_photos

configs = [
    {"age_months": 0, "gender": "boy", "expression": "sleeping"},
    {"age_months": 6, "gender": "girl", "expression": "happy"},
    {"age_months": 18, "gender": None, "expression": "curious"}
]

results = batch_generate_photos(configs)
```

### 2. æ ¹æ®æ¸¸æˆçŠ¶æ€ç”Ÿæˆ

```python
from baby_photo_integration import BabyPhotoGenerator

generator = BabyPhotoGenerator()
result = generator.generate_for_game_state(game_state)
```

### 3. è‡ªå®šä¹‰æç¤ºè¯

ç¼–è¾‘ `chinese_baby_prompts.py`ï¼Œä¿®æ”¹ï¼š
- `POSITIVE_PROMPT_BASE` - æ­£é¢æç¤ºè¯
- `NEGATIVE_PROMPT_BASE` - è´Ÿé¢æç¤ºè¯
- `AGE_STAGE_PROMPTS` - å¹´é¾„é˜¶æ®µæç¤ºè¯
- `EXPRESSION_PROMPTS` - è¡¨æƒ…æç¤ºè¯

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | ç”¨é€” |
|------|------|
| å®å®ç…§ç‰‡åŠŸèƒ½æ€»ç»“.md | å®Œæ•´åŠŸèƒ½æ€»ç»“ |
| å®å®ç…§ç‰‡é›†æˆæŒ‡å—.md | è¯¦ç»†é›†æˆæŒ‡å— |
| ä¿®æ”¹main.pyæŒ‡å—.md | main.py ä¿®æ”¹æ­¥éª¤ |
| å¿«é€Ÿå‚è€ƒå¡.md | å¿«é€ŸæŸ¥é˜…æ‰‹å†Œ |
| ä¸­å›½å®å®ç…§ç‰‡ç”ŸæˆæŒ‡å—.md | æç¤ºè¯è¯¦ç»†è¯´æ˜ |

---

## âœ… æ£€æŸ¥æ¸…å•

å®Œæˆä»¥ä¸‹æ­¥éª¤åï¼Œä½ å°±å¯ä»¥å¼€å§‹ä½¿ç”¨äº†ï¼š

- [ ] å®‰è£… fal-client
- [ ] è·å– fal.ai API å¯†é’¥
- [ ] è®¾ç½® FAL_KEY ç¯å¢ƒå˜é‡
- [ ] è¿è¡Œ test_baby_photo.py æµ‹è¯•
- [ ] ä¿®æ”¹ main.py
- [ ] å¯åŠ¨åº”ç”¨
- [ ] æµ‹è¯• API ç«¯ç‚¹
- [ ] ç”Ÿæˆç¬¬ä¸€å¼ ç…§ç‰‡

---

## ğŸ‰ å®Œæˆï¼

æ­å–œï¼ä½ å·²ç»æˆåŠŸé›†æˆäº†ä¸­å›½å®å®ç…§ç‰‡ç”ŸæˆåŠŸèƒ½ã€‚

**ä¸‹ä¸€æ­¥:**
1. åœ¨æ¸¸æˆä¸­ä½¿ç”¨ç…§ç‰‡ç”ŸæˆåŠŸèƒ½
2. ä¼˜åŒ–æç¤ºè¯ä»¥è·å¾—æ›´å¥½çš„æ•ˆæœ
3. å®ç°ç…§ç‰‡ç¼“å­˜å’Œå­˜å‚¨
4. æ·»åŠ å‰ç«¯ç•Œé¢å±•ç¤ºç…§ç‰‡

**éœ€è¦å¸®åŠ©?**
- æŸ¥çœ‹ç›¸å…³æ–‡æ¡£
- è¿è¡Œæµ‹è¯•è„šæœ¬è¯Šæ–­é—®é¢˜
- æ£€æŸ¥å¸¸è§é—®é¢˜éƒ¨åˆ†

ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸš€
