# 📦 安装依赖说明

## 🎯 你需要安装的依赖

为了实现"上传父母照片生成宝宝照片"功能，需要安装以下依赖：

```
fal-client    - AI 图片生成客户端
Flask         - Web 框架（已安装）
Werkzeug      - Flask 文件上传支持
Pillow        - 图片处理库
```

## 🚀 安装方法

### 方法 1: 使用批处理脚本（推荐）

双击运行：
```
install_face_fusion.bat
```

### 方法 2: 手动安装

打开 **命令提示符 (CMD)**，运行：

```cmd
python -m pip install fal-client
python -m pip install Flask
python -m pip install Werkzeug
python -m pip install Pillow
```

或者一次性安装：

```cmd
python -m pip install fal-client Flask Werkzeug Pillow
```

### 方法 3: 使用国内镜像（如果安装慢）

```cmd
python -m pip install -i https://pypi.tuna.tsinghua.edu.cn/simple fal-client Flask Werkzeug Pillow
```

## ✅ 验证安装

安装完成后，运行测试脚本：

```cmd
python test_face_fusion.py
```

如果看到 "所有测试通过"，说明安装成功！

## 🔑 设置 API 密钥

安装依赖后，需要设置 fal.ai API 密钥：

### 临时设置（当前会话有效）

```cmd
set FAL_KEY=你的fal.ai密钥
```

### 永久设置（推荐）

1. 右键 "此电脑" → 属性
2. 高级系统设置 → 环境变量
3. 在"用户变量"中点击"新建"
4. 变量名：`FAL_KEY`
5. 变量值：你的 fal.ai 密钥
6. 确定保存

### 获取 API 密钥

1. 访问 https://fal.ai/
2. 注册/登录账号
3. 进入 Settings → API Keys
4. 创建新的 API 密钥
5. 复制密钥（类似：`fal_xxx...`）

## 🧪 测试安装

```cmd
# 1. 测试依赖
python test_face_fusion.py

# 2. 启动应用
python main_face_fusion.py

# 3. 访问网页
# 打开浏览器访问: http://localhost:5000
```

## ⚠️ 常见问题

### Q: pip 不是内部或外部命令

**解决：** 使用 `python -m pip` 代替 `pip`

### Q: 安装速度很慢

**解决：** 使用国内镜像（见方法3）

### Q: 权限错误

**解决：** 添加 `--user` 参数
```cmd
python -m pip install --user fal-client Flask Werkzeug Pillow
```

### Q: 已安装但测试失败

**解决：** 
1. 重启命令提示符
2. 检查 Python 版本（需要 3.7+）
3. 重新安装依赖

## 📋 完整流程

```cmd
# 1. 安装依赖
python -m pip install fal-client Flask Werkzeug Pillow

# 2. 设置 API 密钥
set FAL_KEY=你的密钥

# 3. 运行测试
python test_face_fusion.py

# 4. 启动应用
python main_face_fusion.py

# 5. 打开浏览器
# 访问: http://localhost:5000
```

## 🎉 完成！

安装完成后，你就可以：
1. 上传父母照片
2. 选择宝宝年龄
3. 生成预测的宝宝照片

详细使用方法请查看：`面部融合使用指南.md`
